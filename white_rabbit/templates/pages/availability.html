{% extends "base.html" %}
{% load white_rabbit_tags %}
{% load cache %}
{% load static %}

{% block content %}
    <h1 class="text-xl font-bold mb-4 text-left">{{ title }}</h1>
    <div class="overflow-x-scroll w-[80vw]">
        <table class="table w-64">
            <thead>
            <tr class="font-bold bg-indigo-50 text-bold">
                <th class="font-bold text-bold text-black">Employ√©</th>
                {% for period in periods|json_loads %}
                    <th class="min-w-32 font-bold bg-indigo-50">
                        {% if period.start and period.end %}
                            <p class="text-black">{{ period.start }} - {{ period.end }}</p>
                        {% endif %}
                        <span class="uppercase text-gray-500 font-bold">{{ period.key }}</span>
                    </th>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% with events as events_items %}
                {% for employee_events in events_items %}
                    <tr>
                        {% for employee_name, events in employee_events.items %}
                            <td class="font-bold bg-gray-50">{{ employee_name }}</td>
                            {% for week, event in events.items %}
                                <td class="text-center">
                                    <div class="flex">
                                    <span style="background: {{ event_data.availability|week_color }}"
                                          class="pastille pastille-xl">{{ event.availability }}</span>
                                        <div>
                                            {% if event.projects.items %}
                                                <div class="tooltip pastille pastille-sm bg-slate-100 z-100"
                                                     data-tip="{% get_projects_str event.projects projects periodicity %}">
                                                    ?
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </td>
                            {% endfor %}


                        {% endfor %}
                    </tr>
                {% endfor %}
            {% endwith %}
            </tbody>
        </table>
    </div>
{% endblock %}
